<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Banco Imperial | Digital Bank</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #820ad1;
            --primary-light: #a750e8;
            --bg: #f5f5f7;
            --surface: #ffffff;
            --text: #1a1a1a;
            --text-dim: #666666;
            --border: #e5e5e7;
            --success: #00d1b2;
            --danger: #ff3860;
            --gold: #d4af37;
            --glass: rgba(255, 255, 255, 0.7);
            --shadow: 0 8px 30px rgba(0,0,0,0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --bg: #000000;
            --surface: #121212;
            --text: #ffffff;
            --text-dim: #a0a0a0;
            --border: #2c2c2e;
            --glass: rgba(18, 18, 18, 0.8);
            --shadow: 0 8px 30px rgba(0,0,0,0.4);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }

        body { background: var(--bg); color: var(--text); transition: var(--transition); min-height: 100vh; display: flex; justify-content: center; overflow-x: hidden; }

        /* --- UI COMPONENTS --- */
        #app { width: 100%; max-width: 480px; position: relative; min-height: 100vh; background: var(--bg); padding-bottom: 40px; }

        .logo-font { color: var(--primary); font-weight: 800; font-size: 1.5rem; display: flex; align-items: center; gap: 8px; }
        .logo-font i { font-size: 1.8rem; }

        /* Auth Screen */
        .auth-container { padding: 40px 24px; animation: fadeIn 0.6s ease; }
        .auth-card { background: var(--surface); padding: 32px; border-radius: 24px; box-shadow: var(--shadow); border: 1px solid var(--border); margin-top: 30px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 25px; background: var(--bg); padding: 5px; border-radius: 12px; }
        .tab-btn { flex: 1; padding: 12px; border: none; border-radius: 10px; background: transparent; color: var(--text-dim); cursor: pointer; font-weight: 600; transition: var(--transition); }
        .tab-btn.active { background: var(--surface); color: var(--primary); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 600; margin-bottom: 8px; color: var(--text-dim); }
        input { width: 100%; padding: 16px; border-radius: 14px; border: 1px solid var(--border); background: var(--bg); color: var(--text); font-size: 1rem; transition: var(--transition); }
        input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 4px rgba(130, 10, 209, 0.1); }

        .btn-primary { width: 100%; padding: 18px; border: none; border-radius: 16px; background: var(--primary); color: white; font-weight: 700; font-size: 1rem; cursor: pointer; transition: var(--transition); display: flex; justify-content: center; align-items: center; gap: 10px; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(130, 10, 209, 0.3); }

        /* Dashboard */
        .dashboard { display: none; padding: 20px; animation: slideUp 0.5s ease; }
        .dash-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        
        .user-info { display: flex; align-items: center; gap: 12px; }
        .avatar { width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: 700; font-size: 1.2rem; border: 3px solid var(--surface); box-shadow: var(--shadow); }
        .owner-mode .avatar { background: var(--gold); }

        .balance-card { background: var(--primary); color: white; padding: 30px; border-radius: 28px; position: relative; overflow: hidden; margin-bottom: 25px; transition: var(--transition); box-shadow: 0 15px 35px rgba(130, 10, 209, 0.25); }
        .owner-mode .balance-card { background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%); border: 1px solid var(--gold); }
        .balance-card::after { content: ''; position: absolute; top: -50px; right: -50px; width: 150px; height: 150px; background: rgba(255,255,255,0.1); border-radius: 50%; }
        
        .balance-val { font-size: 2.2rem; font-weight: 800; margin: 10px 0; letter-spacing: -1px; }

        /* Actions Grid */
        .actions-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 30px; }
        .action-item { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; }
        .action-icon { width: 60px; height: 60px; background: var(--surface); border-radius: 20px; display: flex; justify-content: center; align-items: center; color: var(--primary); font-size: 1.4rem; box-shadow: var(--shadow); border: 1px solid var(--border); transition: var(--transition); }
        .action-item:hover .action-icon { transform: translateY(-5px); background: var(--primary); color: white; }
        .action-item span { font-size: 0.75rem; font-weight: 600; color: var(--text-dim); }

        /* Cards & Transactions */
        .section-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .card-scroller { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; }
        .card-scroller::-webkit-scrollbar { display: none; }
        .virtual-card { min-width: 280px; height: 170px; background: linear-gradient(135deg, #222, #444); border-radius: 20px; padding: 25px; color: white; position: relative; }
        .card-purple { background: linear-gradient(135deg, var(--primary), var(--primary-light)); }

        .trans-item { background: var(--surface); padding: 16px; border-radius: 18px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border); }
        .trans-info { display: flex; gap: 12px; align-items: center; }
        .trans-icon { width: 40px; height: 40px; border-radius: 12px; display: flex; justify-content: center; align-items: center; font-size: 1rem; }
        .icon-up { background: rgba(0, 209, 178, 0.1); color: var(--success); }
        .icon-down { background: rgba(255, 56, 96, 0.1); color: var(--danger); }

        /* Modals */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 1000; display: none; padding: 24px; overflow-y: auto; }
        .modal-header { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        .back-btn { font-size: 1.5rem; cursor: pointer; }

        /* Theme Toggle */
        .theme-toggle { width: 45px; height: 45px; background: var(--surface); border-radius: 12px; display: flex; justify-content: center; align-items: center; cursor: pointer; border: 1px solid var(--border); box-shadow: var(--shadow); }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #1a1a1a; color: white; padding: 12px 24px; border-radius: 50px; z-index: 2000; font-weight: 500; display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        
        /* Owner Badge */
        .badge-owner { background: var(--gold); color: black; font-size: 0.6rem; font-weight: 900; padding: 2px 6px; border-radius: 4px; vertical-align: middle; margin-left: 5px; }
    </style>
</head>
<body>

    <div id="toast" class="toast">Mensagem Aqui</div>

    <div id="app">
        <div id="auth-screen" class="auth-container">
            <div class="logo-font">
                <i class="fas fa-crown"></i>
                <span>BANCO IMPERIAL</span>
            </div>
            
            <div class="auth-card">
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchAuthTab('login', this)">Entrar</button>
                    <button class="tab-btn" onclick="switchAuthTab('register', this)">Criar Conta</button>
                </div>

                <div id="login-form">
                    <div class="form-group">
                        <label>SEU CPF RP</label>
                        <input type="text" id="login-cpf" placeholder="000.000.000-00" oninput="maskCPF(this)">
                    </div>
                    <button class="btn-primary" onclick="handleLogin()">
                        Entrar na conta <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <div id="register-form" style="display: none;">
                    <div class="form-group">
                        <label>NOME DO PERSONAGEM (RP)</label>
                        <input type="text" id="reg-name" placeholder="Ex: Tutu Protásio">
                    </div>
                    <div class="form-group">
                        <label>CPF DO PERSONAGEM (RP)</label>
                        <input type="text" id="reg-cpf" placeholder="000.000.000-00" oninput="maskCPF(this)">
                    </div>
                    <button class="btn-primary" onclick="handleRegister()">
                        Criar minha conta <i class="fas fa-user-plus"></i>
                    </button>
                </div>
            </div>

            <div style="margin-top: 30px; display: flex; justify-content: center;">
                <div class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </div>
            </div>
        </div>

        <div id="dashboard" class="dashboard">
            <div class="dash-header">
                <div class="user-info">
                    <div class="avatar" id="user-initial">U</div>
                    <div>
                        <p style="font-size: 0.8rem; color: var(--text-dim);">Olá,</p>
                        <strong id="display-name">Carregando...</strong> <span id="owner-badge" class="badge-owner" style="display:none">OWNER</span>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <div class="theme-toggle" onclick="toggleTheme()"><i class="fas fa-sun"></i></div>
                    <div class="theme-toggle" onclick="location.reload()"><i class="fas fa-sign-out-alt"></i></div>
                </div>
            </div>

            <div class="balance-card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-weight: 600; opacity: 0.9;">Saldo em conta</span>
                    <i class="fas fa-eye-slash" style="cursor: pointer;" onclick="toggleBalance(this)"></i>
                </div>
                <div class="balance-val" id="balance-txt">R$ 0,00</div>
                <div style="font-size: 0.8rem; opacity: 0.8;">
                    <i class="fas fa-chart-line"></i> + R$ 0,00 rendendo hoje
                </div>
            </div>

            <div class="actions-grid">
                <div class="action-item" onclick="openModal('modal-pix')">
                    <div class="action-icon"><i class="fas fa-pix"></i></div>
                    <span>Área Pix</span>
                </div>
                <div class="action-item" onclick="openModal('modal-invest')">
                    <div class="action-icon"><i class="fas fa-chart-bar"></i></div>
                    <span>Investir</span>
                </div>
                <div class="action-item" onclick="openModal('modal-boletos')">
                    <div class="action-icon"><i class="fas fa-barcode"></i></div>
                    <span>Boletos</span>
                </div>
                <div class="action-item" onclick="openModal('modal-caixinhas')">
                    <div class="action-icon"><i class="fas fa-box-open"></i></div>
                    <span>Cofres</span>
                </div>
            </div>

            <div class="section-title">Meus cartões</div>
            <div class="card-scroller" id="card-list">
                </div>

            <div class="section-title">Histórico de transações</div>
            <div id="history-list">
                <p style="text-align: center; color: var(--text-dim); margin-top: 20px;">Nenhuma transação ainda.</p>
            </div>
        </div>

        <div id="modal-pix" class="modal">
            <div class="modal-header">
                <i class="fas fa-arrow-left back-btn" onclick="closeModal('modal-pix')"></i>
                <h2 style="font-weight: 800;">Área Pix</h2>
            </div>
            <div class="auth-card">
                <div class="form-group">
                    <label>CPF DO DESTINATÁRIO</label>
                    <input type="text" id="pix-cpf" placeholder="000.000.000-00" oninput="maskCPF(this)">
                </div>
                <div class="form-group">
                    <label>VALOR (R$)</label>
                    <input type="number" id="pix-amount" placeholder="0,00">
                </div>
                <button class="btn-primary" onclick="handlePix()">Enviar Pix</button>
            </div>
            <div style="margin-top: 30px; padding: 20px; background: var(--surface); border-radius: 20px; border: 1px solid var(--border);">
                <p style="color: var(--text-dim); font-size: 0.8rem;">Sua chave Pix CPF:</p>
                <strong id="my-pix-key">000.000.000-00</strong>
            </div>
        </div>

        <div id="modal-invest" class="modal">
            <div class="modal-header">
                <i class="fas fa-arrow-left back-btn" onclick="closeModal('modal-invest')"></i>
                <h2 style="font-weight: 800;">Investimentos</h2>
            </div>
            <p style="color: var(--text-dim); margin-bottom: 20px;">Aplique seu dinheiro em fundos de alto risco (RP).</p>
            
            <div class="auth-card" style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <strong>Fundo Brookasil High</strong>
                    <span style="color: var(--success); font-weight: bold;">+15% ou -10%</span>
                </div>
                <div class="form-group">
                    <label>VALOR PARA INVESTIR</label>
                    <input type="number" id="invest-amount" placeholder="Quanto deseja arriscar?">
                </div>
                <button class="btn-primary" onclick="handleInvestment()">Arriscar Investimento</button>
            </div>
        </div>

        <div id="modal-boletos" class="modal">
            <div class="modal-header">
                <i class="fas fa-arrow-left back-btn" onclick="closeModal('modal-boletos')"></i>
                <h2 style="font-weight: 800;">Boletos</h2>
            </div>
            <div class="tabs">
                <button class="tab-btn active" id="btn-tab-pay" onclick="switchBoletoTab('pay')">Pagar</button>
                <button class="tab-btn" id="btn-tab-gen" onclick="switchBoletoTab('gen')">Gerar</button>
            </div>
            
            <div id="boleto-pay">
                <div class="form-group">
                    <label>CÓDIGO DO BOLETO (CPF DO EMISSOR)</label>
                    <input type="text" id="boleto-code" placeholder="CPF de quem vai receber">
                </div>
                <div class="form-group">
                    <label>VALOR</label>
                    <input type="number" id="boleto-val-pay" placeholder="0,00">
                </div>
                <button class="btn-primary" onclick="handlePayBoleto()">Pagar Agora</button>
            </div>
        </div>

        <div id="modal-caixinhas" class="modal">
            <div class="modal-header">
                <i class="fas fa-arrow-left back-btn" onclick="closeModal('modal-caixinhas')"></i>
                <h2 style="font-weight: 800;">Cofres Imperial</h2>
            </div>
            <div class="auth-card">
                <h3>Reserva de Emergência</h3>
                <p style="font-size: 1.5rem; font-weight: 800; margin: 15px 0;" id="vault-balance">R$ 0,00</p>
                <div class="form-group">
                    <input type="number" id="vault-amount" placeholder="Valor">
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" style="background: var(--success);" onclick="handleVault('in')">Guardar</button>
                    <button class="btn-primary" style="background: var(--danger);" onclick="handleVault('out')">Retirar</button>
                </div>
            </div>
        </div>

    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <script>
        // --- CONFIGURAÇÃO FIREBASE ---
        const firebaseConfig = {
            databaseURL: "https://banco-imperial-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // --- ESTADO GLOBAL ---
        let user = null;
        const TUTU_CPF = "123.456.789-01";

        // --- AUTH LOGIC ---
        function switchAuthTab(type, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('login-form').style.display = type === 'login' ? 'block' : 'none';
            document.getElementById('register-form').style.display = type === 'register' ? 'block' : 'none';
        }

        async function handleRegister() {
            const name = document.getElementById('reg-name').value;
            const cpf = document.getElementById('reg-cpf').value;

            if(!name || cpf.length < 14) return showToast("Preencha os dados corretamente!");

            const snapshot = await db.ref('users/' + cpf.replace(/\D/g, '')).once('value');
            if(snapshot.exists()) {
                showToast("CPF já cadastrado! Redirecionando...");
                return loginDirect(snapshot.val());
            }

            const userData = {
                name: name,
                cpf: cpf,
                balance: 10000,
                vault: 0,
                cards: [{
                    id: Date.now(),
                    number: "4532 •••• •••• " + Math.floor(1000 + Math.random() * 9000),
                    cvv: Math.floor(100 + Math.random() * 899),
                    valid: "12/29",
                    type: 'purple'
                }],
                history: [{
                    type: 'in',
                    title: 'Bônus de Boas-vindas',
                    amount: 10000,
                    date: new Date().getTime()
                }]
            };

            await db.ref('users/' + cpf.replace(/\D/g, '')).set(userData);
            loginDirect(userData);
        }

        async function handleLogin() {
            const cpf = document.getElementById('login-cpf').value.replace(/\D/g, '');
            if(cpf.length < 11) return showToast("CPF inválido!");

            // Lógica Tutu Protásio (Dono)
            if(document.getElementById('login-cpf').value === TUTU_CPF) {
                const tutuData = {
                    name: "Tutu Protásio",
                    cpf: TUTU_CPF,
                    balance: 1500000000000,
                    isOwner: true,
                    history: [{ type: 'in', title: 'Acesso Administrativo', amount: 0, date: Date.now() }]
                };
                return loginDirect(tutuData);
            }

            const snapshot = await db.ref('users/' + cpf).once('value');
            if(snapshot.exists()) {
                loginDirect(snapshot.val());
            } else {
                showToast("Conta não encontrada. Crie uma!");
            }
        }

        function loginDirect(userData) {
            user = userData;
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            if(user.isOwner) document.body.classList.add('owner-mode');
            
            startSync();
            showToast("Bem-vindo ao Banco Imperial!");
        }

        function startSync() {
            if(user.isOwner) {
                updateUI();
                return;
            }
            db.ref('users/' + user.cpf.replace(/\D/g, '')).on('value', (snap) => {
                user = snap.val();
                updateUI();
            });
        }

        // --- DASHBOARD UI ---
        function updateUI() {
            const fmt = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('display-name').innerText = user.name;
            document.getElementById('user-initial').innerText = user.name.charAt(0);
            document.getElementById('balance-txt').innerText = fmt.format(user.balance);
            document.getElementById('my-pix-key').innerText = user.cpf;
            document.getElementById('vault-balance').innerText = fmt.format(user.vault || 0);

            if(user.isOwner) document.getElementById('owner-badge').style.display = 'inline-block';

            // Render Cards
            const cardCont = document.getElementById('card-list');
            cardCont.innerHTML = user.cards?.map(c => `
                <div class="virtual-card ${c.type === 'purple' ? 'card-purple' : ''}">
                    <p style="font-size: 0.8rem; opacity: 0.8;">Cartão Imperial</p>
                    <p style="margin-top: 20px; font-size: 1.2rem; letter-spacing: 2px;">${c.number}</p>
                    <div style="display:flex; justify-content: space-between; margin-top: 30px; font-size: 0.7rem;">
                        <span>VAL: ${c.valid}</span>
                        <span>CVV: ${c.cvv}</span>
                    </div>
                </div>
            `).join('') || '';

            // Render History
            const histCont = document.getElementById('history-list');
            if(user.history) {
                histCont.innerHTML = user.history.reverse().map(h => `
                    <div class="trans-item">
                        <div class="trans-info">
                            <div class="trans-icon ${h.type === 'in' ? 'icon-up' : 'icon-down'}">
                                <i class="fas fa-arrow-${h.type === 'in' ? 'up' : 'down'}"></i>
                            </div>
                            <div>
                                <p style="font-weight: 600; font-size: 0.9rem;">${h.title}</p>
                                <p style="font-size: 0.7rem; color: var(--text-dim);">${new Date(h.date).toLocaleDateString()}</p>
                            </div>
                        </div>
                        <strong style="color: ${h.type === 'in' ? 'var(--success)' : 'var(--text)'}">
                            ${h.type === 'in' ? '+' : '-'} ${fmt.format(h.amount)}
                        </strong>
                    </div>
                `).join('');
            }
        }

        // --- FUNCIONALIDADES ---
        async function handlePix() {
            const destCpf = document.getElementById('pix-cpf').value.replace(/\D/g, '');
            const amount = parseFloat(document.getElementById('pix-amount').value);

            if(amount > user.balance) return showToast("Saldo insuficiente!");
            if(amount <= 0) return showToast("Valor inválido!");

            const destSnap = await db.ref('users/' + destCpf).once('value');
            if(!destSnap.exists()) return showToast("Destinatário não encontrado!");

            const destData = destSnap.val();

            // Retirar do remetente
            const newHistorySender = [...(user.history || []), {
                type: 'out',
                title: 'Pix Enviado: ' + destData.name,
                amount: amount,
                date: Date.now()
            }];
            await db.ref('users/' + user.cpf.replace(/\D/g, '')).update({
                balance: user.balance - amount,
                history: newHistorySender
            });

            // Adicionar ao destinatário
            const newHistoryDest = [...(destData.history || []), {
                type: 'in',
                title: 'Pix Recebido: ' + user.name,
                amount: amount,
                date: Date.now()
            }];
            await db.ref('users/' + destCpf).update({
                balance: destData.balance + amount,
                history: newHistoryDest
            });

            showToast("Pix enviado com sucesso!");
            closeModal('modal-pix');
        }

        async function handleInvestment() {
            const amount = parseFloat(document.getElementById('invest-amount').value);
            if(amount > user.balance || amount <= 0) return showToast("Saldo insuficiente!");

            const win = Math.random() > 0.5;
            const multiplier = win ? 1.15 : 0.90;
            const newBalance = user.balance * multiplier;
            const diff = Math.abs(user.balance - newBalance);

            const newHistory = [...(user.history || []), {
                type: win ? 'in' : 'out',
                title: win ? 'Lucro em Investimento' : 'Prejuízo em Investimento',
                amount: diff,
                date: Date.now()
            }];

            await db.ref('users/' + user.cpf.replace(/\D/g, '')).update({
                balance: newBalance,
                history: newHistory
            });

            showToast(win ? "Você lucrou R$ " + diff.toFixed(2) : "Você perdeu R$ " + diff.toFixed(2));
        }

        async function handleVault(type) {
            const amount = parseFloat(document.getElementById('vault-amount').value);
            if(isNaN(amount) || amount <= 0) return;

            let newBal = user.balance;
            let newVault = user.vault || 0;

            if(type === 'in') {
                if(amount > user.balance) return showToast("Saldo insuficiente!");
                newBal -= amount;
                newVault += amount;
            } else {
                if(amount > newVault) return showToast("Cofre insuficiente!");
                newBal += amount;
                newVault -= amount;
            }

            await db.ref('users/' + user.cpf.replace(/\D/g, '')).update({
                balance: newBal,
                vault: newVault
            });
            showToast("Cofre atualizado!");
        }

        // --- UTILITÁRIOS ---
        function maskCPF(i) {
            let v = i.value.replace(/\D/g, "");
            v = v.replace(/(\d{3})(\d)/, "$1.$2");
            v = v.replace(/(\d{3})(\d)/, "$1.$2");
            v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
            i.value = v;
        }

        function toggleTheme() {
            const current = document.body.getAttribute('data-theme');
            const target = current === 'dark' ? 'light' : 'dark';
            document.body.setAttribute('data-theme', target);
            localStorage.setItem('theme', target);
            document.getElementById('theme-icon').className = target === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        function openModal(id) { document.getElementById(id).style.display = 'block'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // Init Theme
        if(localStorage.getItem('theme') === 'dark') toggleTheme();
    </script>
</body>
</html>

